from pubcrypt.cryptosystem.rsa import *
from pubcrypt.number.primality import *
from pubcrypt.number.util import *

from pubcrypt.scheme.oaep import rsa_oaep_encrypt

from benchmark.gcd import *
from benchmark.pow import *
from benchmark.generate import *


"""
This test verify that everything work correcly. You can call every functions you want below.
"""


def launch_test():
    """ Launch this script to see if everything in pubcrypt module is working """
    try:
        n, e, d = generate(2048, e=65537)
        prime_recovery(n, e, d)
        get_prime_factor(1024, 65537)
        
    except:
        ValueError("Test failed")


def new_test():
    pass


if __name__ == "__main__":
    #launch_test()

    m = randrange(pow(2, 256), pow(2, 1024))
    n = 10702293051885749701201731625112199250903588966958472674938144097021309479619535049845298107996230284126705951396165474806892936036148695322244403269578315007910881235021074561913454111914836242096697248142239917704556362027857926088252723428274214084038609171155275958001657393554287860509337819742071081980297737016457936418295748380524562410968464480913194193898455305994444022901044745449880477713868709014249230513282523442239244645671967233685646291022137157865535828749671049344411111568150540350177799227769877471425977623048153063862767259104326745395708807377242509725447099610968045482934336369086966886913
    e = 65537
    d = 3552461709427080870347169839521045859654190371655928934351654587280491423465269473340778721048415301293809012720633897476984740383758468011048793028768583619666651057977149640964116159583065254902902969865668052699161070838671610298363515959819296781729037092166438396483941207857850956215880112465767647548634881497546676281666790906567077708345117183677743092770787254799931844146746993407156171276742355001282959388492652598040742309712772454483217862752478770221813879656334367925603026241609024785793813005046164228689345988264622558099131091077480268003051631075414731377423665481375925211390704325969951139433
    rsa_oaep_encrypt(m, e, n, "test_label")